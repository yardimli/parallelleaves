<!doctype html>
<html lang="en" class="h-full">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
	<meta http-equiv="Content-Security-Policy"
	      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' file: data: https:;">
	<title>Novel Editor</title>
	<link rel="stylesheet" href="../node_modules/bootstrap-icons/font/bootstrap-icons.css">
	<link rel="stylesheet" href="../dist/styles.css">
</head>
<body class="h-full bg-base-100 text-base-content overflow-hidden select-none flex flex-col">

<div id="top-toolbar"
     class="flex-shrink-0 h-12 bg-base-100/80 dark:bg-base-300/80 backdrop-blur-sm flex items-center px-4 gap-2 z-50 border-b border-base-300 dark:border-base-100/10">
	<!-- Toolbar content from blade file -->
	<!-- History Section -->
	<div class="flex items-center gap-1">
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="undo"
		        title="Undo (Ctrl+Z)" disabled>
			<i class="bi bi-arrow-counterclockwise text-lg"></i>
		</button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="redo"
		        title="Redo (Ctrl+Y)" disabled>
			<i class="bi bi-arrow-clockwise text-lg"></i>
		</button>
	</div>
	<div class="divider divider-horizontal mx-0"></div>
	
	<!-- Heading Dropdown -->
	<div class="dropdown js-dropdown-container">
		<button type="button" tabindex="0" role="button"
		        class="js-toolbar-btn js-heading-btn btn btn-ghost btn-sm w-28 justify-start" disabled>Paragraph
		</button>
		<div tabindex="0" class="js-dropdown dropdown-content z-[1] menu p-1 shadow bg-base-100 rounded-box w-40">
			<button class="js-heading-option p-2 rounded w-full text-left text-sm hover:bg-base-200" data-level="0">
				Paragraph
			</button>
			<button class="js-heading-option p-2 rounded w-full text-left text-xl font-bold hover:bg-base-200" data-level="1">
				Heading 1
			</button>
			<button class="js-heading-option p-2 rounded w-full text-left text-lg font-bold hover:bg-base-200" data-level="2">
				Heading 2
			</button>
			<button class="js-heading-option p-2 rounded w-full text-left text-base font-bold hover:bg-base-200"
			        data-level="3">Heading 3
			</button>
			<button class="js-heading-option p-2 rounded w-full text-left text-sm font-bold hover:bg-base-200" data-level="4">
				Heading 4
			</button>
		</div>
	</div>
	<div class="divider divider-horizontal mx-0"></div>
	
	<!-- Formatting Section -->
	<div class="flex items-center gap-1">
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square font-bold" data-command="bold"
		        title="Bold" disabled>B
		</button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square italic" data-command="italic"
		        title="Italic" disabled>I
		</button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square underline" data-command="underline"
		        title="Underline" disabled>U
		</button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square line-through" data-command="strike"
		        title="Strikethrough" disabled>S
		</button>
		<div class="dropdown js-dropdown-container">
			<button type="button" tabindex="0" role="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square"
			        title="Highlight" disabled>
				<i class="bi bi-highlighter text-lg"></i>
			</button>
			<div tabindex="0" class="js-dropdown dropdown-content z-[1] menu p-1 shadow bg-base-100 rounded-box w-32">
				<button
					class="js-highlight-option p-1 rounded w-full text-left flex items-center gap-2 text-xs hover:bg-base-200"
					data-bg="highlight-yellow"><span class="w-4 h-4 rounded-full" style="background-color: #fef08a;"></span>
					Yellow
				</button>
				<button
					class="js-highlight-option p-1 rounded w-full text-left flex items-center gap-2 text-xs hover:bg-base-200"
					data-bg="highlight-green"><span class="w-4 h-4 rounded-full" style="background-color: #a7f3d0;"></span> Green
				</button>
				<button
					class="js-highlight-option p-1 rounded w-full text-left flex items-center gap-2 text-xs hover:bg-base-200"
					data-bg="highlight-blue"><span class="w-4 h-4 rounded-full" style="background-color: #bfdbfe;"></span> Blue
				</button>
				<button
					class="js-highlight-option p-1 rounded w-full text-left flex items-center gap-2 text-xs hover:bg-base-200"
					data-bg="highlight-red"><span class="w-4 h-4 rounded-full" style="background-color: #fecaca;"></span> Red
				</button>
				<button class="js-highlight-option p-1 rounded w-full text-left text-xs hover:bg-base-200"
				        data-bg="transparent">None
				</button>
			</div>
		</div>
	</div>
	<div class="divider divider-horizontal mx-0"></div>
	
	<!-- Block Formatting Section -->
	<div class="flex items-center gap-1">
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="bullet_list"
		        title="Bullet List" disabled><i class="bi bi-list-ul text-lg"></i></button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="ordered_list"
		        title="Ordered List" disabled><i class="bi bi-list-ol text-lg"></i></button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="blockquote"
		        title="Blockquote" disabled><i class="bi bi-quote text-lg"></i></button>
		<button type="button" class="js-toolbar-btn btn btn-ghost btn-sm btn-square" data-command="horizontal_rule"
		        title="Horizontal Rule" disabled><i class="bi bi-hr text-lg"></i></button>
	</div>
	<div class="divider divider-horizontal mx-0"></div>
	
	<div class="flex items-center gap-1">
		<button type="button" class="js-toolbar-btn js-ai-action-btn btn btn-ghost btn-sm" data-action="rephrase" title="Rephrase Selection" disabled>Rephrase</button>
	</div>
	
	<div class="flex-grow"></div>
	<div class="flex items-center text-sm text-base-content/70">
		<span id="js-word-count">No text selected</span>
	</div>
</div>

<div id="viewport" class="relative flex-grow z-10 overflow-hidden">
	<div id="desktop" class="absolute" style="width: 15000px; height: 15000px; transform-origin: 0 0;">
	</div>
</div>

<div id="taskbar"
     class="flex-shrink-0 h-12 bg-base-100/80 dark:bg-base-300/80 backdrop-blur-sm flex items-center px-2 gap-2 z-50 border-t border-base-300 dark:border-base-100/10">
	<div class="dropdown dropdown-top">
		<button id="open-windows-btn" tabindex="0" role="button" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-window-stack text-lg"></i>
		</button>
		<div id="open-windows-menu" tabindex="0"
		     class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-64">
			<ul id="open-windows-list" class="max-h-80 overflow-y-auto">
				<!-- Window list will be populated by JS -->
			</ul>
		</div>
	</div>
	
	<div id="minimized-windows-container" class="flex items-center gap-2 flex-grow min-w-0">
		<!-- Minimized windows will be dynamically inserted here -->
	</div>
	
	<div class="ml-auto flex items-center gap-1">
		<button id="zoom-out-btn" type="button" title="Zoom Out" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-zoom-out text-lg"></i>
		</button>
		<button id="zoom-100-btn" type="button" title="Zoom to 100%" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-aspect-ratio text-lg"></i>
		</button>
		<button id="zoom-in-btn" type="button" title="Zoom In" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-zoom-in text-lg"></i>
		</button>
		<button id="zoom-fit-btn" type="button" title="Fit to View" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-arrows-fullscreen text-lg"></i>
		</button>
		<div class="divider divider-horizontal mx-0"></div>
		<button id="arrange-windows-btn" type="button" title="Arrange Windows" class="btn btn-ghost btn-sm btn-square">
			<i class="bi bi-grid-3x3-gap text-lg"></i>
		</button>
		
		<label id="theme-toggle" class="swap swap-rotate btn btn-ghost btn-sm btn-square">
			<input type="checkbox" class="theme-controller" value="dark"/>
			<i class="swap-off bi bi-sun-fill text-lg"></i>
			<i class="swap-on bi bi-moon-fill text-lg"></i>
		</label>
	</div>
</div>

<dialog id="prompt-editor-modal" class="modal">
	<div class="modal-box w-11/12 max-w-5xl h-[90vh] flex flex-col p-0">
		<div class="flex flex-grow overflow-hidden">
			<main class="w-full flex flex-col overflow-hidden">
				<div class="js-prompt-placeholder flex-grow flex items-center justify-center">
					<p class="text-base-content/60">Loading editor...</p>
				</div>
				<div class="js-custom-editor-pane hidden flex-grow flex flex-col min-h-0">
					<div class="p-4 border-b border-base-300 flex-shrink-0">
						<h3 class="js-custom-prompt-title text-lg font-bold"></h3>
					</div>
					<div class="js-custom-form-container flex-grow overflow-y-auto min-h-0">
						<div class="p-4 text-center">
							<span class="loading loading-spinner"></span>
						</div>
					</div>
				</div>
			</main>
		</div>
		<div class="modal-action px-6 py-4 border-t border-base-300 flex-shrink-0 flex justify-between items-center">
			<div class="flex items-center gap-4">
				<button type="button" class="js-toggle-preview-btn btn btn-ghost">Show Preview</button>
				<select class="js-llm-model-select select select-bordered select-sm w-full max-w-xs">
					<option disabled selected>Loading models...</option>
				</select>
				<button type="button" class="js-prompt-apply-btn btn btn-accent">Apply Changes</button>
			</div>
			<form method="dialog">
				<button class="btn">Close</button>
			</form>
		</div>
	</div>
</dialog>

<dialog id="new-chapter-modal" class="modal">
	<div class="modal-box">
		<h3 class="font-bold text-lg">Create New Chapter</h3>
		<form id="new-chapter-form" novalidate>
			<div class="py-4 max-h-[70vh] overflow-y-auto space-y-4">
				<div id="new-chapter-error-container" class="hidden alert alert-error"></div>
				<div class="form-control">
					<label for="new-chapter-title" class="label"><span class="label-text">Title <span
						class="text-error">*</span></span></label>
					<input type="text" id="new-chapter-title" name="title" class="input input-bordered" required>
				</div>
				<div class="form-control">
					<label for="new-chapter-summary" class="label"><span class="label-text">Summary (Optional)</span></label>
					<textarea id="new-chapter-summary" name="summary" rows="3" class="textarea textarea-bordered"></textarea>
				</div>
				<div class="form-control">
					<label for="new-chapter-position" class="label"><span class="label-text">Position <span
						class="text-error">*</span></span></label>
					<select id="new-chapter-position" name="position" class="select select-bordered" required>
						<option value="" disabled selected>Insert after...</option>
						<!-- Options will be populated by JS -->
					</select>
				</div>
			</div>
			<div class="modal-action">
				<button type="button" class="js-close-new-chapter-modal btn">Cancel</button>
				<button type="submit" class="js-new-chapter-submit-btn btn btn-accent w-28">
					<span class="js-btn-text">Create</span>
					<span class="js-spinner hidden animate-spin"><i class="bi bi-arrow-repeat"></i></span>
				</button>
			</div>
		</form>
	</div>
</dialog>

<dialog id="chapter-pov-modal" class="modal">
	<div class="modal-box">
		<h3 class="font-bold text-lg">Chapter Point of View</h3>
		<p class="py-2 text-sm text-base-content/70">Override the novel's default POV settings for this chapter.</p>
		<form id="chapter-pov-form" novalidate>
			<input type="hidden" id="pov-chapter-id" name="chapterId">
			<div class="py-4 max-h-[70vh] overflow-y-auto space-y-4">
				<div id="chapter-pov-error-container" class="hidden alert alert-error"></div>
				
				<!-- POV Type -->
				<div class="form-control">
					<label for="chapter_pov_type" class="label"><span class="label-text">Point of View (POV)</span></label>
					<select id="chapter_pov_type" name="pov" class="select select-bordered">
						<option value="first_person">1st Person</option>
						<option value="second_person">2nd Person</option>
						<option value="third_person">3rd Person</option>
						<option value="third_person_limited">3rd Person (Limited)</option>
						<option value="third_person_omniscient">3rd Person (Omniscient)</option>
					</select>
					<div class="label">
						<span class="label-text-alt">The perspective from which the story is told.</span>
					</div>
				</div>
				
				<!-- POV Character -->
				<div class="form-control">
					<label for="chapter_pov_character" class="label"><span class="label-text">POV Character (Optional)</span></label>
					<select id="chapter_pov_character" name="pov_character_id" class="select select-bordered">
						<option value="">— None —</option>
						<!-- Character options populated by JS -->
					</select>
					<div class="label">
						<span class="label-text-alt">Select a character from the Codex.</span>
					</div>
				</div>
			</div>
			<div class="modal-action justify-between">
				<button type="button" class="js-delete-pov-override-btn btn btn-error">Delete Override</button>
				<div class="flex gap-2">
					<button type="button" class="js-close-pov-modal btn">Cancel</button>
					<button type="submit" class="js-save-pov-btn btn btn-primary w-28">
						<span class="js-btn-text">Save</span>
						<span class="js-spinner hidden animate-spin"><i class="bi bi-arrow-repeat"></i></span>
					</button>
				</div>
			</div>
		</form>
	</div>
</dialog>

<script src="../src/js/theme.js"></script>
<script src="../dist/editor-bundle.js"></script>
</body>
</html>
