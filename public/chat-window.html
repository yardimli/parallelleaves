<!doctype html>
<html lang="en" class="h-full">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
	<meta http-equiv="Content-Security-Policy"
	      content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' file: data: https:;">
	<title data-i18n="editor.chat.title">Parallel Leaves - AI Chat</title>
	<link rel="stylesheet" href="../node_modules/bootstrap-icons/font/bootstrap-icons.css">
	<link rel="stylesheet" href="../dist/styles.css">
</head>
<body class="h-full bg-base-100 text-base-content overflow-hidden flex flex-col">

<!-- Top Bar -->
<div class="flex-shrink-0 h-14 bg-base-200 flex items-center px-4 gap-4 z-10 border-b border-base-300">
	<h1 class="text-lg font-bold" data-i18n="editor.chat.title">AI Chat</h1>
	<div class="flex-grow"></div>
	<select id="js-llm-model-select" class="select select-bordered select-sm w-full max-w-xs">
		<option disabled selected data-i18n="editor.chat.loadingModels">Loading models...</option>
	</select>
	<!-- Temperature Slider -->
	<div class="flex items-center gap-2">
		<label class="text-sm font-medium" data-i18n="editor.temperature">Temperature</label>
		<input type="range" min="0" max="2" value="0.7" step="0.1" id="js-ai-temperature-slider" class="range range-xs w-24" />
		<span id="js-ai-temperature-value" class="text-sm font-mono w-8 text-center">0.7</span>
	</div>
</div>

<!-- Chat Management and Chapter Selector - NEW BLOCK -->
<div class="flex-shrink-0 p-4 border-b border-base-300 bg-base-200 flex flex-wrap items-center gap-4">
	<!-- Chat Selector -->
	<div class="dropdown dropdown-hover">
		<div tabindex="0" role="button" class="btn btn-sm" id="js-current-chat-name" data-i18n="editor.chat.newChat">New Chat</div>
		<ul tabindex="0" class="dropdown-content z-[1] menu p-2 shadow bg-base-100 rounded-box w-52" id="js-chat-list">
			<!-- Chat history items will be dynamically inserted here -->
		</ul>
	</div>
	<button id="js-new-chat-btn" class="btn btn-sm btn-outline"><i class="bi bi-plus-circle"></i> <span data-i18n="editor.chat.newChat">New Chat</span></button>
	<button id="js-delete-chat-btn" class="btn btn-sm btn-outline btn-error"><i class="bi bi-trash"></i> <span data-i18n="editor.chat.deleteChat">Delete Chat</span></button>
	
	<!-- Chapter Selector -->
	<select id="js-chapter-select" class="select select-bordered select-sm flex-grow min-w-[150px]">
		<option value="" disabled selected data-i18n="editor.chat.selectChapter">Select Chapter (Optional)</option>
		<option value="none" data-i18n="editor.chat.noChapter">No Chapter</option>
	</select>
</div>

<!-- Chat History -->
<div id="js-chat-history" class="flex-grow p-4 overflow-y-auto space-y-4">
	<!-- Messages will be appended here by JS -->
</div>

<!-- Input Area -->
<div class="flex-shrink-0 p-4 border-t border-base-300 bg-base-200">
	<form id="js-chat-form" class="flex items-start gap-2">
		<textarea id="js-chat-input" class="textarea textarea-bordered w-full resize-none" rows="2"
		          data-i18n-placeholder="editor.chat.sendMessagePlaceholder"></textarea>
		<button type="submit" id="js-send-btn" class="btn btn-primary btn-square">
			<i class="bi bi-send-fill text-lg"></i>
		</button>
	</form>
</div>

<script src="../src/js/theme.js"></script>
<script type="module" src="../src/js/chat-window.js"></script>
</body>
</html>
